<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>React Orcus - Manual Tests</title>
    
    <script type="text/javascript" src="../../node_modules/@babel/standalone/babel.js"></script>
    <script type="text/javascript" src="../../node_modules/react/umd/react.development.js"></script>
    <script type="text/javascript" src="../../node_modules/react-dom/umd/react-dom.development.js"></script>
    <script type="text/javascript" src="../../node_modules/moment-duration-format/lib/moment-duration-format.js"></script>
    
    <script type="text/javascript" src="../../dist/react-orcus.js"></script>
    
    <style type="text/css">
        
        
        
        /* */
        
        #view-container {
            width: 900px;
            height: 750px;
        }
        
        .orcus-desktop {
            background-color: #eee;
            border: 5px #000 solid;
        }
        
        /* apps */
        
        #stopwatch time {
            display: block;
            font-family: calibri, sans-serif;
            font-size: 3em;
            margin: 20px auto;
            text-align: center;
        }
        
        #stopwatch .clock-controls {
            text-align: center;
        }
        
        #stopwatch .clock-controls button {
            font-size: 2em;
            margin: 5px;
        }
        
        #stopwatch .start { color: green; }
        #stopwatch .stop { color: red; }
        #stopwatch .pause { color: orange; }
        #stopwatch .resume { color: skyblue; }
        
        #browserify img {
            margin: auto;
            position: absolute;
                top: 0;
                bottom: 0;
            width: calc(100% - 4px);
            max-height: 100%;
        }
        
    </style>
    
</head>

<body>
    
    <div id="view-container">
    
    </div>
    
    <script type="module">
        import moment from "../../node_modules/moment/dist/moment.js";
        window.moment = moment;
    </script>

    <script type="text/babel">
        
        momentDurationFormatSetup(moment);

        function Stopwatch (props) {
            var [start, setStart] = React.useState(null),
                [end, setEnd] = React.useState(null),
                [looper, loop] = React.useState(0),
                format = function (m) {
                    return m.format("HH:mm:ss.SSS", {trim: false});
                },
                duration = function () {
                    return moment.duration((end || moment()).diff(start));
                };
            
            // loop
            setTimeout(function () { loop(++looper); }, 50);
            
            function onStart (e) {
                setStart(moment());
                setEnd(null);
            }
            
            function onResume (e) {
                setStart(moment().subtract(duration()));
                setEnd(null);
            }
            
            // render
            return (
                <div className="stopwatch">
                    <time>
                        {
                            start ?
                                
                            format(duration()) :
                            
                            format(moment.duration(0))
                        }
                    </time>
                           
                    <div className="clock-controls">
                        {
                            !start ?
                                
                            <button className="start" onClick={onStart}>
                                Start
                            </button> :
                            
                            <button className="stop" onClick={e => setStart(null)}>
                                Stop
                            </button>
                        }
                        
                        {
                            !end ?
                                
                            <button className="pause" onClick={e => setEnd(moment())}>
                                Pause
                            </button> :
                            
                            <button className="resume" onClick={onResume}>
                                Resume
                            </button>
                        }
                    </div>
                </div>
            );   
        }
        
        ReactDOM.render(
            (
                <Orcus.Desktop taskbar="bottom">
                    <Orcus.App
                        slug="file-manager"
                        name="File Manager"
                        icon="fa:folder"
                        initialOpened={true}
                        initialPosition={[150, 200, 500, 300]}
                    >
                        <h1>Welcome to my File Manager</h1>
            
                        <p>Yeah so.... building a file manager is really hard.
                        But please enjoy this complimentary welcome paragraph!</p>
                    </Orcus.App>
                    
                    <Orcus.App
                        slug="tetris"
                        name="Tetris"
                        icon="fa:th-large"
                        initialPosition={[550, 150, 280, 450]}    //{x, y, w, h}
                    >
                        <p>Does anyone know how to build a tetris game?</p>
                    </Orcus.App>
                    
                    <Orcus.App
                        id="stopwatch"
                        slug="stopwatch"
                        name="Stopwatch"
                        icon="fa:clock-o"
                        initialPosition={[200, 180, 300, 200]}
                    >
                        <Stopwatch />
                    </Orcus.App>
                    
                    <Orcus.App
                        id="browserify"
                        slug="browserify"
                        name="Browserify"
                        icon="fa-solid:file-image"
                        initialPosition={[120, 60, 500, 500]}
                    >
                        <img
                            src="../../node_modules/stream-http/test/server/static/browserify.png"
                            alt="Browserify"
                        />
                    </Orcus.App>
                </Orcus.Desktop>
            ),
            document.getElementById("view-container")
        );
        
    </script>

</body>
</html>
